# Aeon

[![Github All Releases](https://img.shields.io/github/downloads/aeonix/aeon/total.svg)](../../releases)
[![GitHub release](https://img.shields.io/github/release/aeonix/aeon/all.svg)](../../releases/latest)
[![GitHub Release Date](https://img.shields.io/github/release-date-pre/aeonix/aeon.svg)](../../releases/latest)
[![GitHub top language](https://img.shields.io/github/languages/top/aeonix/aeon.svg)](../../)
[![GitHub language count](https://img.shields.io/github/languages/count/aeonix/aeon.svg)](../../)
[![GitHub repo size in bytes](https://img.shields.io/github/repo-size/aeonix/aeon.svg)](../../)

[![GitHub last commit](https://img.shields.io/github/last-commit/aeonix/aeon.svg)](../../)
[![Github commits (since latest release)](https://img.shields.io/github/commits-since/aeonix/aeon/latest.svg)](../../)
[![GitHub stars](https://img.shields.io/github/stars/aeonix/aeon.svg)](../../stargazers)
[![GitHub forks](https://img.shields.io/github/forks/aeonix/aeon.svg)](../../network)
[![GitHub issues](https://img.shields.io/github/issues/aeonix/aeon.svg)](../../issues)
[![GitHub closed issues](https://img.shields.io/github/issues-closed/aeonix/aeon.svg)](../../issues)

Copyright (c) 2014-2018, AEON, The Monero Project.   
Portions Copyright (c) 2012-2013 The Cryptonote developers.

## Ресурсы разработки

- Сайт: [aeon.cash](https://aeon.cash)
- Bitcointalk: https://bitcointalk.org/index.php?topic=641696.0
- Reddit: https://www.reddit.com/r/Aeon
- GitHub: [https://github.com/aeonix/aeon](https://github.com/aeonix/aeon)
- IRC: [#aeon on Freenode](https://webchat.freenode.net/?randomnick=1&channels=%23aeon&prompt=1&uio=d4)
- Discord: https://discord.gg/TM8mEsx

## Реакция на уязвимость

- Реакция на уязвимость должна быть переадресована в Monero, поскольку большая часть кодовой базы Aeon является общей
- Наш [процесс реагирования на уязвимость]((https://github.com/monero-project/meta/blob/master/VULNERABILITY_RESPONSE_PROCESS.md) поощряет ответственное раскрытие информации
- Мы также доступны на [HackerOne](https://hackerone.com/monero)

## Объявления

- Вы можете подписаться на [список объявлений](https://docs.google.com/forms/d/e/1FAIpQLSci2UitA67N0W_xgSPLlGj6acGnTOtTdDR_ODZwXTHXZsWnCQ/viewform), чтобы получать критические важные объявления от основной команды Aeon. Список объявлений может быть полезен, чтобы знать, когда нужно обновить программное обеспечение.

## Покрытие

| Type      | Status |
|-----------|--------|
| Лицензия  | [![License](https://img.shields.io/badge/license-BSD3-blue.svg)](https://opensource.org/licenses/BSD-3-Clause)

## Введение

Aeon - это приватная, безопасная, защищенная, не отслеживаемая, децентрализованная цифровая валюта. Вы являетесь вашим банком, вы контролируете свои средства, и никто не может отследить ваши переводы, если вы не позволите им это сделать.

**Приватность:** Aeon использует криптографическую систему, позволяющую отправлять и получать денежные средства, не раскрывая транзакции в блокчейне (книге транзакций, которая есть у всех участников сети). Это гарантирует, что ваши покупки, чеки и переводы останутся абсолютно конфиденциальными по умолчанию.

**Безопасность:** Используя потенциал распределенной пиринговой консенсус-сети, каждая транзакция защищена криптографически. Индивидуальные кошельки имеют мнемоническую фразу из 25 слов, которая отображается только один раз, и может быть записана для резервного копирования кошелька. Файлы кошелька зашифрованы паролем, чтобы быть уверенными, что они бесполезны в случае кражи.

**Неотслеживаемость:** Используя кольцевые подписи, которые являются особым свойством определенного типа криптографии, Aeon может гарантировать, что транзакции не только не отслеживаются, но и имеют опциональную неопределенность, которая обеспечивает затрудненную привязку транзакций к конкретному пользователю или компьютеру.

## О проекте

Это основная реализация Aeon. Проект поставляется с открытым исходным кодом и полностью свободен для использования без ограничений, за исключением тех, которые указаны в лицензионном соглашении ниже. Нет никаких ограничений на создание альтернативной реализации Aeon, которая будет использовать протокол и сеть совместимым образом.

Как и во многих других проектах, репозиторий на Github считается "плацдармом" для последних изменений. Перед включением изменений в основную ветвь репозитория, отдельные разработчики тестируют эти изменения в своих собственных ветках, после чего отправляют запрос на их добавление в основную ветку, а затем проверяются специалистами, которые занимаются тестированием и анализом кода. Учитывая вышесказанное, перед использованием в рабочей среде, репозиторий должен быть тщательно проработан, если только в репозитории нет патча для конкретной задачи. Обычно для обеспечения стабильности лучше использовать тегированный релиз.

**Приглашаем всех внести свой вклад в код Aeon!** Если у вас есть какое-то улучшение или исправление кода, не стесняйтесь отправить его в виде запроса непосредственно в  главную ветвь. В тех случаях, когда изменение относительно невелико или не затрагивает другие части кодовой базы, оно может быть немедленно добавлено в основную ветку любым из участников проекта. С другой стороны, если изменение является особенно крупным или сложным, оно будет подробно рассматриваться либо задолго до подачи запроса на добавление в основную ветку, либо непосредственно при подаче запроса.

## Поддержка проекта

Aeon - проект на 100% спонсируемый сообществом. Если вы хотите присоединиться к проекту, самое простое, что вы можете сделать, это оказать финансовую поддержку проекту. Пожертвования как в Aeon, так и в Bitcoin могут быть сделаны на **donate.aeon.cash**, если вы используете клиент, который поддерживает стандарт [OpenAlias](https://openalias.org). Также вы можете отправить AEON на адрес пожертвования Aeon с помощью команды `donate` (введите `help` в консольном кошельке для получения дополнительной информации).

Адрес пожертвования для Aeon: `WmsSWgtT1JPg5e3cK41hKXSHVpKW7e47bjgiKmWZkYrhSS5LhRemNyqayaSBtAQ6517eo5PtH9wxHVmM78JDZSUu2W8PqRiNs` (viewkey: `71bf19a7348ede17fa487167710dac401ef1556851bfd36b76040facf051630b`)

Адрес пожертвования для Bitcoin: `12Cyjf3qV6qLyXdzpLSLPdRFPUVidvnzFM`

Основное финансирование разработки и/или некоторые вспомогательные расходы также любезно предоставляются спонсорами.:

[<img width="80" src="https://static.getmonero.org/images/sponsors/mymonero.png"/>](https://mymonero.com)
[<img width="150" src="https://static.getmonero.org/images/sponsors/kitware.png?1"/>](https://kitware.com)
[<img width="100" src="https://static.getmonero.org/images/sponsors/dome9.png"/>](https://dome9.com)
[<img width="150" src="https://static.getmonero.org/images/sponsors/araxis.png"/>](https://araxis.com)
[<img width="150" src="https://static.getmonero.org/images/sponsors/jetbrains.png"/>](https://www.jetbrains.com/)
[<img width="150" src="https://static.getmonero.org/images/sponsors/navicat.png"/>](https://www.navicat.com/)
[<img width="150" src="https://static.getmonero.org/images/sponsors/symas.png"/>](https://www.symas.com/)

Существует также несколько майнинговых пулов, которые любезно жертвуют часть своих сборов, список которых можно найти [в нашем посте на Bitcointalk](https://bitcointalk.org/index.php?topic=641696.0).

## Лицензия

Посмотрите [ЛИЦЕНЗИЮ](LICENSE).

## Вклад в проект

Если вы хотите помочь, смотрите раздел [ВКЛАД В ПРОЕКТ](CONTRIBUTING.md), где приведен ряд рекомендаций.

## Обновления программного обеспечения

Для реализации новых функций, Aeon использует механизм обновления программного обеспечения (hard fork). Это означает, что пользователи Aeon (конечные пользователи и поставщики услуг) должны использовать новейшие версии и обновлять программное обеспечение по мере необходимости. **В отличие от Monero, не существует фиксированного графика хардфорков, и дата следующего хардфорка будет определяться органически в ходе обсуждения на уровне сообщества.** Необходимое программное обеспечение для этих обновлений будет доступно до запланированной даты. Пожалуйста, проверьте правильность версии программного обеспечения Aeon в репозитории до этой даты. Ниже приведен исторический график и прогнозируемый график следующего обновления.
Даты указаны в формате YYYYY-MM-DD.


| Высота блока обновления программного обеспечения | Дата       | Версия форка | Минимальная версия Aeon | Рекомендуемая версия Aeon | Детали                                                                            |  
| ------------------------------ | -----------| ----------------- | ---------------------- | -------------------------- | ---------------------------------------------------------------------------------- |
| 592000                        | 2015-08-04 | v1 (exceptional, version not bumped)      | v0.9.0.0                 | v0.9.14.0                     | время блока = 240 секунд, CryptoNight-Lite, снижение приоритетности майнинга при размере кольца < 3       |
| 963500                        | 2018-06-03 | v7                | v0.12.0.0                 | v0.12.9.0-aeon                    | Переход на последнюю версию кода Monero с отключенным RingCT, CryptoNight-Lite вариант 1, ограниченное использование ringsize 1, запрет ringsize 2.   |

## Компиляция Aeon из исходников

### Зависимости

В следующей таблице приведены инструменты и библиотеки, необходимые для сборки. Несколько библиотек также включены в этот репозиторий (помечены знаком "Vendored"). По умолчанию при компиляции используется библиотека, установленная в вашей системе, и игнорируются внешние источники. Однако, если библиотека, установленная в вашей системе, не найдена, внешний источник будет собран и использован. Внешние источники также используются для статической сборки, так как распространяемые пакеты часто содержат только бинарные файлы разделяемой библиотеки (.so), но не являются статическими библиотечными архивами (.a).

| Dep          | Min. version  | Vendored | Debian/Ubuntu pkg  | Arch pkg     | Fedora            | Optional | Purpose        |
| ------------ | ------------- | -------- | ------------------ | ------------ | ----------------- | -------- | -------------- |
| GCC          | 4.7.3         | NO       | `build-essential`  | `base-devel` | `gcc`             | NO       |                |
| CMake        | 3.5           | NO       | `cmake`            | `cmake`      | `cmake`           | NO       |                |
| pkg-config   | any           | NO       | `pkg-config`       | `base-devel` | `pkgconf`         | NO       |                |
| Boost        | 1.58          | NO       | `libboost-all-dev` | `boost`      | `boost-devel`     | NO       | C++ libraries  |
| OpenSSL      | basically any | NO       | `libssl-dev`       | `openssl`    | `openssl-devel`   | NO       | sha256 sum     |
| libzmq       | 3.0.0         | NO       | `libzmq3-dev`      | `zeromq`     | `cppzmq-devel`    | NO       | ZeroMQ library |
| OpenPGM      | ?             | NO       | `libpgm-dev`       | `libpgm`     | `openpgm-devel`   | NO       | For ZeroMQ     |
| libnorm[2]   | ?             | NO       | `libnorm-dev`      |              |               `   | YES      | For ZeroMQ     |
| libunbound   | 1.4.16        | YES      | `libunbound-dev`   | `unbound`    | `unbound-devel`   | NO       | DNS resolver   |
| libsodium    | ?             | NO       | `libsodium-dev`    | `libsodium`  | `libsodium-devel` | NO       | cryptography   |
| libunwind    | any           | NO       | `libunwind8-dev`   | `libunwind`  | `libunwind-devel` | YES      | Stack traces   |
| liblzma      | any           | NO       | `liblzma-dev`      | `xz`         | `xz-devel`        | YES      | For libunwind  |
| libreadline  | 6.3.0         | NO       | `libreadline6-dev` | `readline`   | `readline-devel`  | YES      | Input editing  |
| ldns         | 1.6.17        | NO       | `libldns-dev`      | `ldns`       | `ldns-devel`      | YES      | SSL toolkit    |
| expat        | 1.1           | NO       | `libexpat1-dev`    | `expat`      | `expat-devel`     | YES      | XML parsing    |
| GTest        | 1.5           | YES      | `libgtest-dev`[1]  | `gtest`      | `gtest-devel`     | YES      | Test suite     |
| Doxygen      | any           | NO       | `doxygen`          | `doxygen`    | `doxygen`         | YES      | Documentation  |
| Graphviz     | any           | NO       | `graphviz`         | `graphviz`   | `graphviz`        | YES      | Documentation  |
| pcsclite     | ?             | NO       | `libpcsclite-dev`  | ?            | `pcsc-lite pcsc-lite-devel` | NO | Ledger     |          


[1] В Debian/Ubuntu `libgtest-dev` включает только исходники и заголовки. Вы должны собрать бинарный файл библиотеки вручную. Это можно сделать с помощью следующей команды ```sudo apt-get install libgtest-dev && cd /usr/src/gtest && sudo cmake . && sudo make && sudo mv libg* /usr/lib/ ```
[2] libnorm-dev необходим, если ваша библиотека zmq была собрана с libnorm, а иначе не нужен.

Установка всех зависимостей одновременно на Debian/Ubuntu:
``` sudo apt update && sudo apt install build-essential cmake git pkg-config libboost-all-dev libssl-dev libzmq3-dev libunbound-dev libsodium-dev libunwind8-dev liblzma-dev libreadline6-dev libldns-dev libexpat1-dev doxygen graphviz libpcsclite-dev libpgm-dev```
### Клонирование репозитория

Клонирование рекурсивно для получения необходимых модулей:

`$ git clone --recursive https://github.com/aeonix/aeon`

Если у вас уже есть клон репозитория, инициируйте и обновите его:

`$ cd aeon && git submodule init && git submodule update`

### Инструкция по сборке

Aeon использует систему сборки CMake и файл Makefile (Makefile) верхнего уровня, вызывающий команды cmake по мере необходимости.

#### На Linux и OS X

* Установите зависимости
* Перейдите в корневую директорию исходного кода, измените его на последний тег релиза и соберите его::

        cd aeon
        git checkout v0.12.9.0-aeon
        make

    *Опционально*: Если ваш компьютер имеет несколько ядер и достаточно памяти, включите параллельную сборку, запустив `make -j <количество потоков>`, а не `make`. Для этого компютер должен иметь одно ядро и около 2 ГБ оперативной памяти на поток.

    *Примечание*: Если cmake не может найти файл zmq.hpp на OS X, установка `zmq.hpp` с
    https://github.com/zeromq/cppzmq в `/usr/local/include` должна решить эту проблему.

    *Примечание*: Приведенные выше инструкции соберут наиболее стабильный выпуск программного обеспечения Aeon. Если вы хотите использовать и протестировать новейшее программное обеспечение, используйте ```git checkout master```. Главная ветка может содержать как нестабильные, так и несовместимые с релизом обновления, хотя тестирование всегда приветствуется.

* Полученные исполняемые файлы находятся в  `build/release/bin`

* Добавьте `PATH="$PATH:$HOME/aeon/build/release/bin"` к `.profile`

* Запустите Aeon с `aeond --detach`

* **Опционально**: соберите и запустите тестовый пакет для проверки бинарных файлов:

        make release-test

    *Примечание*: `core_tests` проверка может занять несколько часов..

* **Опционально**: для сборки бинарных файлов, пригодных для отладки:

         make debug

* **Опционально**: для сборки статически скомпонованных бинарных файлов:

         make release-static

Зависимости должны быть собраны с помощью -fPIC. Статические библиотеки обычно таковыми не являются, поэтому вам, возможно, придется собирать их самостоятельно с помощью -fPIC. Информацию о том, как их собрать, смотрите в их документации.

* **Опционально**: создайте документацию в `doc/html` (пропустите `HAVE_DOT=YES` если `graphviz` не установлен):

        HAVE_DOT=YES doxygen Doxyfile

#### На Raspberry Pi

Протестировано на Raspberry Pi Zero с чистой установкой минимального Raspbian Stretch (2017-09-07 или более поздней версии) с сайта https://www.raspberrypi.org/downloads/raspbian/. Если вы используете Raspian Jessie, [см. примечание в следующем разделе](#note-for-raspbian-jessie-users).

* `apt-get update && apt-get upgrade` чтобы установить все новейшее программное обеспечение

* Установите зависимости для Aeon из столбца 'Debian' в таблице выше.

* Увеличьте размер swap:
```
	sudo /etc/init.d/dphys-swapfile stop  
	sudo nano /etc/dphys-swapfile  
	CONF_SWAPSIZE=2048
	sudo /etc/init.d/dphys-swapfile start  
```
* При использовании внешнего жесткого диска без внешнего источника питания убедитесь, что он получает достаточно энергии, чтобы избежать аппаратных проблем при синхронизации, добавив строку "max_usb_current=1" в /boot/config.txt

* Склонируйте Aeon и проверьте последнюю версию релиза:
```
	git clone https://github.com/aeonix/aeon.git
	cd aeon
	git checkout tags/v0.12.9.0-aeon
```
* Соберите:
```
        make release
```
* Ждите 4-6 часов

* Полученные исполняемые файлы можно найти в `build/release/bin`

* Добавьте `PATH="$PATH:$HOME/aeon/build/release/bin"` к `.profile`

* Запустите Aeon с `aeond --detach`

* Вы можете уменьшить размер файла подкачки после завершения сборки и удалить каталог boost из домашней директории

#### *Примечание для пользователей Raspbian Jessie:*

Если вы используете более старый образ Raspbian Jessie, компиляция Aeon будет немного сложнее. Версия Boost, доступная в репозиториях Debian Jessie, слишком старая для использования с Aeon, и поэтому вы должны скомпилировать новую версию самостоятельно. Следующее объясняет дополнительные шаги и было протестировано на Raspberry Pi 2 с чистой установкой минимальной Raspbian Jessie.

* Как и прежде, `apt-get update && apt-get upgrade` для установки всего новейшего программного обеспечения и увеличения размера системной подкачки

```
	sudo /etc/init.d/dphys-swapfile stop  
	sudo nano /etc/dphys-swapfile  
	CONF_SWAPSIZE=2048  
	sudo /etc/init.d/dphys-swapfile start  
```

* Затем установите зависимости для Aeon, за исключением `libunwind` и `libboost-all-dev`

* Установите последнюю версию boost (может потребоваться выполнение команды `apt-get remove --purge libboost*` для удаления предыдущей версии, если вы не используете чистую установку):
```
	cd  
	wget https://sourceforge.net/projects/boost/files/boost/1.64.0/boost_1_64_0.tar.bz2  
	tar xvfo boost_1_64_0.tar.bz2  
	cd boost_1_64_0  
	./bootstrap.sh  
	sudo ./b2  
```
* Ждите ~8 часов
```
	sudo ./bjam cxxflags=-fPIC cflags=-fPIC -a install
```
* Ждите ~4 часов

* Отсюда следуйте [общим инструкциям для Raspberry Pi](#on-the-raspberry-pi) с шага "Склонируйте Aeon и проверьте последнюю версию релиза".

#### На Windows:

Бинарные файлы для Windows собираются на Windows с использованием инструментария MinGW в среде [MSYS2](https://www.msys2.org). Среда MSYS2 эмулирует систему POSIX. Инструментарий работает в среде и *перекрестно компилирует* бинарные файлы, которые могут запускаться вне среды, как обычные приложения Windows.

**Подготовка рабочей среды**

* Загрузите и установите программу [MSYS2](https://www.msys2.org), 64-битный или 32-битный пакет, в зависимости от вашей системы.
* Откройте оболочку MSYS через ярлык `MSYS2 Shell`
* Обновите пакеты с помощью pacman:  

        pacman -Syu  

* Завершите работу с оболочкой MSYS с помощью Alt+F4  
* Отредактируйте свойства ярлыка `MSYS2 Shell` изменив "msys2_shell.bat" на "msys2_shell.cmd -mingw64" для 64-битных сборок или "msys2_shell.cmd -mingw32" для 32-битных сборок.
* Перезапустите MSYS оболочку с помощью модифицированного ярлыка и обновите пакеты снова с помощью pacman:  

        pacman -Syu  


* Установите зависимости:

    Для сборки под 64-битную версию Windows:

        pacman -S mingw-w64-x86_64-toolchain make mingw-w64-x86_64-cmake mingw-w64-x86_64-boost mingw-w64-x86_64-openssl mingw-w64-x86_64-zeromq mingw-w64-x86_64-libsodium

    Для сборки под 32-битную версию Windows:

        pacman -S mingw-w64-i686-toolchain make mingw-w64-i686-cmake mingw-w64-i686-boost mingw-w64-i686-openssl mingw-w64-i686-zeromq mingw-w64-i686-libsodium

* Откройте оболочку MingW с помощью ярлыка `MinGW-w64-Win64 Shell` на 64-битной Windows или `MinGW-w64-Win64 Shell`
  на 32-битной Windows. Обратите внимание, что если вы используете 64-битную ОС Windows, у вас будут 64-битные и 32-битные MinGW-оболочки..

**Клонирование**

* Чтобы клонировать, введите:

        git clone --recursive https://github.com/aeonix/aeon.git

**Сборка**

* Перейдите в клонированную директорию, введите:

        cd aeon

* Если вам нужна специфическая [версия/тег](https://github.com/aeonix/aeon/tags), сделайте git checkout для этой версии, например, 'v0.12.9.0-aeon'. Если вам не важна версия, а просто нужны бинарные файлы с мастер-ветки -- пропустите этот шаг:

        git checkout v0.12.9.0-aeon

* Если вы работаете на 64-битной системе, введите:

        make release-static-win64

* Если вы работаете на 64-битной системе, введите:

        make release-static-win32

* Полученные исполняемые файлы можно найти в `build/release/bin`

* **Опционально**: сборка подходящих для отладки бинарных файлов Windows на 64-битной системе, введите:

        make debug-static-win64

* **Опционально**: сборка бинарных файлов Windows, пригодных для отладки на 32-битной системе, введите:

        make debug-static-win32

* Полученные исполняемые файлы можно найти в `build/debug/bin`

### На FreeBSD:

Проект можно собрать с нуля, следуя инструкциям для Linux, приведенным выше. Если вы используете Aeon в jail, вам нужно добавить флаг: `allow.sysvipc=1` к вашей jail конфигурации, иначе lmdb выдаст сообщение об ошибке: `Failed to open lmdb environment: Function not implemented` ("Не удалось открыть среду lmdb. Функция не реализована").

В ближайшее время мы планируем добавить Aeon в древовидную структуру портов, что поможет в управлении установками с помощью портов или пакетов.

### На OpenBSD:

#### OpenBSD < 6.2

Это было протестировано на OpenBSD 5.8.

Вам нужно будет добавить несколько пакетов в свою систему. `pkg_add db cmake gcc gcc-libs g++ gtest`.

Пакеты doxygen и graphviz являются необязательными и требуют наличие набора xbase.

Пакет Boost содержит ошибку, которая не позволит правильно собрать librpc.a. Для того, чтобы исправить это, вы должны будете собрать boost с нуля. Следуйте инструкциям в этой части (в разделе "Сборка Boost"): https://github.com/bitcoin/bitcoin/blob/master/doc/build-openbsd.md

Вам придется добавить сериализацию, модули date_time и regex в Boost при сборке так как это необходимо для Aeon.

Чтобы собрать: `env CC=egcc CXX=eg++ CPP=ecpp DEVELOPER_LOCAL_TOOLS=1 BOOST_ROOT=/path/to/the/boost/you/built make release-static-64`

#### OpenBSD >= 6.2

Вам нужно будет добавить несколько пакетов в свою систему. `pkg_add cmake zeromq libiconv`.

Пакеты doxygen и graphviz являются необязательными и требуют наличие набора xbase.


Соберите библиотеку Boost с помощью clang. Данное руководство создано на основе: https://github.com/bitcoin/bitcoin/blob/master/doc/build-openbsd.md

Мы предполагаем, что вы компилируете не под root-пользователем и у вас включена функция `doas'.

Примечание: не используйте пакет boost, предоставляемый OpenBSD, так как мы устанавливаем boost в `/usr/local`.

```
# Создать каталог для сборки boost
mkdir ~/boost
cd ~/boost

# Получите boost из источника
ftp -o boost_1_64_0.tar.bz2 https://netcologne.dl.sourceforge.net/project/boost/boost/1.64.0/boost_1_64_0.tar.bz2

# ДОЛЖНЫ получить на выходе: (SHA256) boost_1_64_0.tar.bz2: OK
echo "7bcc5caace97baa948931d712ea5f37038dbb1c5d89b43ad4def4ed7cb683332 boost_1_64_0.tar.bz2" | sha256 -c
tar xfj boost_1_64_0.tar.bz2

# Получить и применить boost-патчи, необходимые для OpenBSD.
ftp -o boost_test_impl_execution_monitor_ipp.patch https://raw.githubusercontent.com/openbsd/ports/bee9e6df517077a7269ff0dfd57995f5c6a10379/devel/boost/patches/patch-boost_test_impl_execution_monitor_ipp
ftp -o boost_config_platform_bsd_hpp.patch https://raw.githubusercontent.com/openbsd/ports/90658284fb786f5a60dd9d6e8d14500c167bdaa0/devel/boost/patches/patch-boost_config_platform_bsd_hpp

# Должны получить на выходе: (SHA256) boost_config_platform_bsd_hpp.patch: OK
echo "1f5e59d1154f16ee1e0cc169395f30d5e7d22a5bd9f86358f738b0ccaea5e51d boost_config_platform_bsd_hpp.patch" | sha256 -c
# Должны получить на выходе: (SHA256) boost_test_impl_execution_monitor_ipp.patch: OK
echo "30cec182a1437d40c3e0bd9a866ab5ddc1400a56185b7e671bb3782634ed0206 boost_test_impl_execution_monitor_ipp.patch" | sha256 -c

cd boost_1_64_0
patch -p0 < ../boost_test_impl_execution_monitor_ipp.patch
patch -p0 < ../boost_config_platform_bsd_hpp.patch

# Начните сборку boost
echo 'using clang : : c++ : <cxxflags>"-fvisibility=hidden -fPIC" <linkflags>"" <archiver>"ar" <striper>"strip"  <ranlib>"ranlib" <rc>"" : ;' > user-config.jam
./bootstrap.sh --without-icu --with-libraries=chrono,filesystem,program_options,system,thread,test,date_time,regex,serialization,locale --with-toolset=clang
./b2 toolset=clang cxxflags="-stdlib=libc++" linkflags="-stdlib=libc++" -sICONV_PATH=/usr/local
doas ./b2 -d0 runtime-link=shared threadapi=pthread threading=multi link=static variant=release --layout=tagged --build-type=complete --user-config=user-config.jam -sNO_BZIP2=1 -sICONV_PATH=/usr/local --prefix=/usr/local install
```

Сборка cppzmq

Соберите cppzmq.

Мы предполагаем, что вы компилируете не под root-пользователем и у вас включена функция `doas'.

```
# Создание директории для сборки cppzmq
mkdir ~/cppzmq
cd ~/cppzmq

# Получите cppzmq из исходника
ftp -o cppzmq-4.2.3.tar.gz https://github.com/zeromq/cppzmq/archive/v4.2.3.tar.gz

# ДОЛЖНЫ получить на выходе: (SHA256) cppzmq-4.2.3.tar.gz: OK
echo "3e6b57bf49115f4ae893b1ff7848ead7267013087dc7be1ab27636a97144d373 cppzmq-4.2.3.tar.gz" | sha256 -c
tar xfz cppzmq-4.2.3.tar.gz

# Начните сборку cppzmq
cd cppzmq-4.2.3
mkdir build
cd build
cmake ..
doas make install
```

Соберите Aeon: `env DEVELOPER_LOCAL_TOOLS=1 BOOST_ROOT=/usr/local make release-static`

### На Solaris:

Стандартный компоновщик Solaris нельзя использовать, вам нужно установить GNU ld, затем запустить cmake вручную, указав путь к вашей копии GNU ld:

        mkdir -p build/release
        cd build/release
        cmake -DCMAKE_LINKER=/path/to/ld -D CMAKE_BUILD_TYPE=Release ../..
        cd ../..

Тогда вы сможете запускать, как обычно.

### На Linux для Android (ипользуя docker):

        # Соберите образ (для ARM 32-bit)
        docker build -f utils/build_scripts/android32.Dockerfile -t aeon-android .
        # Соберите образ (для ARM 64-bit)
        docker build -f utils/build_scripts/android64.Dockerfile -t aeon-android .
        # Создайте контейнер
        docker create -it --name aeon-android aeon-android bash
        # Получите бинарники
        docker cp aeon-android:/src/build/release/bin .

### Создание портативных статически связанных бинарных файлов

По умолчанию, в динамически или статически связанных сборках, бинарные файлы нацелены на определенный хост-процессор, на котором происходит сборка, и не переносятся на другие процессоры. Портативные бинарные файлы могут быть собраны с помощью следующих объектов:

* ```make release-static-linux-x86_64``` собирает бинарные файлы на Linux на x86_64 портативные в системах POSIX на процессорах x86_64
* ```make release-static-linux-i686``` собирает бинарные файлы под Linux на x86_64 или i686, портативные в системах POSIX на процессорах i686
* ```make release-static-linux-armv8``` собирает бинарные файлы на платформе Linux, портативные в системах POSIX на процессорах armv8
* ```make release-static-linux-armv7``` собирает бинарные файлы на платформе Linux, портативные в системах POSIX на процессорах armv7
* ```make release-static-linux-armv6``` собирает бинарные файлы на платформе Linux, портативные в системах POSIX на процессорах armv6
* ```make release-static-win64``` собирает бинарные файлы на 64-битной платформе Windows, портативной для 64-битных Windows систем
* ```make release-static-win32``` собирает бинарные файлы на 64-битной или 32-битной Windows, портативной для 32-битных Windows систем

## Установка Aeon из пакета

**ДИСКЛАЙМЕР: Данные пакеты не являются частью этого репозитория и не поддерживаются участниками проекта, и, как таковые, не проходят такой же процесс проверки безопасность и надежность.**

Пакеты доступны для

* (**НУЖНО СДЕЛАТЬ**) ~Ubuntu и [поддержка snap](https://snapcraft.io/docs/core/install), через сборку, сделанную сообществом.~

        snap install aeon --beta

~Установка snap происходит очень быстро. Пакеты snap являются безопасными. Они изолированы со всеми своими зависимостями. Они также автоматически обновляются при появлении новой версии.~

* (**НУЖНО СДЕЛАТЬ**) ~Arch Linux (через [AUR](https://aur.archlinux.org/)):~
  - ~Стабильный релиз: [`aeon`](https://aur.archlinux.org/packages/aeon)~
  - ~Bleeding edge: [`aeon-git`](https://aur.archlinux.org/packages/aeon-git)~

* (**НУЖНО СДЕЛАТЬ**) ~Void Linux:~

        xbps-install -S aeon

* (**НУЖНО СДЕЛАТЬ**) ~GuixSD~

        guix package -i aeon

* OS X через [Homebrew](https://brew.sh)

        brew tap sammy007/aeon
        brew install aeon -v

* Docker

        # Сборка с использованием всех доступных ядер
        docker build -t aeon .

        # или сборка с использованием определенного количества ядер (уменьшение потребности в оперативной памяти)
        docker build --build-arg NPROC=1 -t aeon .

        # либо запустите на переднем плане
        docker run -it -v /aeon/chain:/root/.aeon -v /aeon/wallet:/wallet -p 11180:11180 aeon

        # или на заднем
        docker run -it -d -v /aeon/chain:/root/.aeon -v /aeon/wallet:/wallet -p 11180:11180 aeon

* Сборке требуется 3 гигабайта свободного места.
* Ждите один час или больше.

Приветствуется создание пакета для вашего любимого дистрибутива!

## Запуск aeond

Сборка помещает бинарный файл в подкаталог `bin/` в каталог сборки с которого был вызван cmake (репозиторий root по умолчанию). Чтобы запустить на переднем плане:

    ./bin/aeond

Чтобы перечислить все доступные опции, запустите `./bin/aeond --help`. Опции могут
быть указаны либо в командной строке, либо в конфигурационном файле, передаваемом
с помощью команды `--config-file`. Чтобы указать опцию в конфигурационном файле, добавьте строку с синтаксисом
`argumentname=value`, где `argumentname` - это имя аргумента без тире, например `log-level=1`.

Чтобы запустить на заднем плане:

    ./bin/aeond --log-file aeond.log --detach

Для запуска в качестве службы systemd скопируйте [aeond.service](utils/systemd/aeond.service) в `/etc/systemd/system/` и [aeond.conf](utils/conf/aeond.conf) в `/etc/`.
[Сервис example](utils/systemd/aeond.service) предполагает, что aeon существует, и располагается в каталоге данных, указанных в [конфигурации примера](utils/conf/aeond.conf).


Если вы работаете на Mac, вам может понадобиться добавить опцию `--max-concurrency 1` к aeon-wallet-cli, и, возможно, aeond, если вы получаете сообщения о сбоях.


## Интернационализация

Посмотрите [README.i18n.md](README.i18n.md).

## Использование Tor

Хотя в Aeon не предусмотрена интеграция с Tor, его можно использовать с torsocks, настройка параметров конфигурации и переменных окружения:

* `--p2p-bind-ip 127.0.0.1` в командной строке или `p2p-bind-ip=127.0.0.1` в aeond.conf отключить возможность прослушивания соединений на внешних интерфейсах.
* `--no-igd` в командной строке или `no-igd=1` в aeond.conf отключить IGD (согласование перенаправление портов UPnP), что бессмысленно при использовании Tor.
* `DNS_PUBLIC=tcp` или `DNS_PUBLIC=tcp://x.x.x.x` где x.x.x.x IP-адрес нужного DNS-сервера, для запросов DNS, проходящих через TCP, так что они маршрутизируются через Tor. Если IP-адрес не указан, aeond использует список серверов по умолчанию, определенный в [src/common/dns_utils.cpp](src/common/dns_utils.cpp).
* `TORSOCKS_ALLOW_INBOUND=1` чтобы сказать torsocks, чтобы позволить Aeond связать интерфейсы, чтобы принимать соединения из кошелька. В некоторых Linux-системах torsocks позволяет привязываться к localhost по умолчанию, поэтому установка этой переменной необходима только для привязки к локальным интерфейсам LAN/VPN, чтобы кошельки могли соединяться с удаленных хостов. В других системах она может понадобиться и для локальных кошельков.
* НЕ пропускайте `--detach` когда запускаете через torsocks с systemd, (смотрите [utils/systemd/aeond.service](utils/systemd/aeond.service) for details).
* Если вы используете кошелек вместе с демоном Tor через loopback IP (например, 127.0.0.0.1:9050), то используйте `--untrusted-daemon`, если это не ваш собственный скрытый сервис.

Пример командной строки для запуска через Tor:

    DNS_PUBLIC=tcp torsocks aeond --p2p-bind-ip 127.0.0.1 --no-igd

### Использование Tor в Tails

TAILS поставляется с очень ограниченным набором правил фаервола. Поэтому вам нужно добавить правило, разрешающее соединение, в дополнение к тому, что вы говорите torsocks, разрешающим входящие соединения. Полный пример:

    sudo iptables -I OUTPUT 2 -p tcp -d 127.0.0.1 -m tcp --dport 11181 -j ACCEPT
    DNS_PUBLIC=tcp torsocks ./aeond --p2p-bind-ip 127.0.0.1 --no-igd --rpc-bind-ip 127.0.0.1 \
        --data-dir /home/amnesia/Persistent/your/directory/to/the/blockchain

## Отладка

Этот раздел содержит общие инструкции по отладке неудачных установок или проблем с Aeon. Сначала убедитесь, что вы используете последнюю версию, собранную из репо Github.

### Получение результатов анализа стека и отвалов ядра на Unix-системах

Мы обычно используем инструмент `gdb' (отладчик GNU) для обеспечения функциональности трассировки стека и `ulimit` для создания дампов ядра в сборках, которые завершаются сбоями или ошибками сегментации.

* Использовать gdb для получения трассировки стека для остановившейся сборки:

Запустите сборку.

Как только она остановится, введите следующую команду:

```
gdb /path/to/aeond `pidof aeond`
```

Введите `thread apply all bt` в пределах gdb для получения трассировки стека

* Если вы все равно получаете отвалы, или сбои в работе ядра:

Введите `ulimit -c unlimited` в командной строке чтобы чтобы разрешить неограниченный размер файлов для дампов ядра

Введите `echo core | sudo tee /proc/sys/kernel/core_pattern` чтобы предотвратить захват ядер другими инструментами.

Запустите сборку.

Когда она заканчивается выдачей с выходными данными "Segmentation fault (core dumped)", в том же каталоге, что и aeond, должен быть файл дампа ядра. Он может называться просто `core` или `core.xxxx` с добавленными цифрами.

Теперь вы можете проанализировать этот дамп ядра с помощью команды `gdb' следующим образом:

`gdb /path/to/aeond /path/to/dumpfile`

Выведите трассировку стека с помощью команды `bt`

* Чтобы запустить aeond в пределах gdb:

Введите `gdb /path/to/aeond`

Передавайте опции командной строки с помощью команды `--args` после чего следуют соответствующие аргументы.

Введите `run` чтобы запустить aeond

### Анализ повреждения памяти

Имеются два инструмента:

* ASAN

Настройте Aeon при помощи -D SANITIZE=ON cmake, например:

    cd build/debug && cmake -D SANITIZE=ON -D CMAKE_BUILD_TYPE=Debug ../..

Затем вы можете запустить aeon инструменты в обычном режиме. Производительность, как правило, снижается вдвое.

* valgrind

Установите valgrind и запустите как `valgrind /path/to/aeond`. Это будет очень медленно.

### LMDB

Инструкции по отладке подозреваемой в наличии повреждений в блокчейне в соответствии с требованиями @HYC

В источнике LMDB есть команда `mdb_stat`, которая может вывести статистику о базе данных, но она не является стандартной. Это может быть собрано с помощью следующей команды:

`cd ~/aeon/external/db_drivers/liblmdb && make`

Вывод `mdb_stat -ea <path to blockchain dir>` указывает на несоответствия в блоках, block_heights и block_info.

Вывод `mdb_dump -s blocks <path to blockchain dir>` и `mdb_dump -s block_info <path to blockchain dir>` полезен для определения содержат ли блоки и block_info одни и те же ключи.

Эти записи выгружаются в виде шестнадцатеричных данных, где первая строка является ключевой, а вторая строка - данными.
